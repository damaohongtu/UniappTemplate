{"version":3,"file":"user.js","sources":["pages/user/user.vue","D:/HBuilderX/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvdXNlci91c2VyLnZ1ZQ"],"sourcesContent":["<template>\r\n\t<view class=\"userLayout pageBg\" v-if=\"userinfo\">\r\n\t\t<view :style=\"{height:getNavBarHeight()+'px'}\"></view>\r\n\r\n\t\t<view class=\"userInfo\">\r\n\t\t\t<view class=\"avatar\">\r\n\t\t\t\t<image src=\"../../static/images/xxmLogo.png\" mode=\"aspectFill\"></image>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"ip\">{{userinfo.IP}}</view>\r\n\t\t\t<view class=\"address\">来自于： {{ userinfo.address.city || userinfo.address.province || userinfo.address.country}}\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t\t\t\r\n\t\t<view class=\"section\">\r\n\t\t\t<view class=\"list\">\r\n\t\t\t\t<navigator \r\n\t\t\t\turl=\"/pages/classlist/classlist?name=我的下载&type=download\" \r\n\t\t\t\tclass=\"row\">\r\n\t\t\t\t\t<view class=\"left\">\r\n\t\t\t\t\t\t<uni-icons type=\"download-filled\" size=\"20\" ></uni-icons>\r\n\t\t\t\t\t\t<view class=\"text\">我的下载</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"right\">\r\n\t\t\t\t\t\t<view class=\"text\">{{userinfo.downloadSize}}</view>\r\n\t\t\t\t\t\t<uni-icons type=\"right\" size=\"15\" color=\"#aaa\"></uni-icons>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</navigator>\r\n\t\t\t\t\r\n\t\t\t\t<navigator  \r\n\t\t\t\turl=\"/pages/classlist/classlist?name=我的评分&type=score\" \r\n\t\t\t\tclass=\"row\">\r\n\t\t\t\t\t<view class=\"left\">\r\n\t\t\t\t\t\t<uni-icons type=\"star-filled\" size=\"20\"></uni-icons>\r\n\t\t\t\t\t\t<view class=\"text\">我的评分</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"right\">\r\n\t\t\t\t\t\t<view class=\"text\">{{userinfo.scoreSize}}</view>\r\n\t\t\t\t\t\t<uni-icons type=\"right\" size=\"15\" color=\"#aaa\"></uni-icons>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</navigator>\r\n\t\t\t\t\r\n\t\t\t\t<view class=\"row\">\r\n\t\t\t\t\t<view class=\"left\">\r\n\t\t\t\t\t\t<uni-icons type=\"chatboxes-filled\" size=\"20\"></uni-icons>\r\n\t\t\t\t\t\t<view class=\"text\">联系客服</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"right\">\r\n\t\t\t\t\t\t<view class=\"text\"></view>\r\n\t\t\t\t\t\t<uni-icons type=\"right\" size=\"15\" color=\"#aaa\"></uni-icons>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<!-- #ifdef MP -->\r\n\t\t\t\t\t<button open-type=\"contact\">联系客服</button>\r\n\t\t\t\t\t<!-- #endif -->\r\n\t\t\t\t\t<!-- #ifndef MP -->\r\n\t\t\t\t\t<button @click=\"clickContact\">拨打电话</button>\r\n\t\t\t\t\t<!-- #endif -->\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t\r\n\t\t<view class=\"section\">\r\n\t\t\t<view class=\"list\">\r\n\t\t\t\t<navigator url=\"/pages/notice/detail?id=653507c6466d417a3718e94b\" class=\"row\">\r\n\t\t\t\t\t<view class=\"left\">\r\n\t\t\t\t\t\t<uni-icons type=\"notification-filled\" size=\"20\"></uni-icons>\r\n\t\t\t\t\t\t<view class=\"text\">订阅更新</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"right\">\r\n\t\t\t\t\t\t<view class=\"text\"></view>\r\n\t\t\t\t\t\t<uni-icons type=\"right\" size=\"15\" color=\"#aaa\"></uni-icons>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</navigator>\r\n\t\t\t\t\r\n\t\t\t\t<navigator url=\"/pages/notice/detail?id=6536358ce0ec19c8d67fbe82\" class=\"row\">\r\n\t\t\t\t\t<view class=\"left\">\r\n\t\t\t\t\t\t<uni-icons type=\"flag-filled\" size=\"20\"></uni-icons>\r\n\t\t\t\t\t\t<view class=\"text\">常见问题</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"right\">\r\n\t\t\t\t\t\t<view class=\"text\"></view>\r\n\t\t\t\t\t\t<uni-icons type=\"right\" size=\"15\" color=\"#aaa\"></uni-icons>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</navigator>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t\r\n\t</view>\r\n\t\r\n\t<view class=\"userLayout pageBg\" v-else>\r\n\t\t<view :style=\"{height:getNavBarHeight()+'px'}\"></view>\r\n\t\t<!-- <uni-load-more status=\"loading\"></uni-load-more> -->\r\n\t\t<view class=\"userInfo\">\r\n\t\t\t<view class=\"avatar\">\r\n\t\t\t\t<image src=\"../../static/images/xxmLogo.png\" mode=\"aspectFill\"></image>\r\n\t\t\t</view>\r\n\r\n\t\t</view>\r\n\r\n\t\t\r\n\t\t<button class=\"loginBtn\" open-type=\"getUserInfo\" @click=\"wxLogin\">\r\n\t\t\t微信一键登录\r\n\t\t</button>\r\n\t</view>\r\n</template>\r\n\r\n\r\n\r\n<script setup>\r\nimport {getNavBarHeight} from \"@/utils/system.js\"\r\nimport {apiUserInfo} from \"@/api/apis.js\"\r\nimport { ref } from \"vue\";\r\n\r\nconst userinfo = ref(null)\r\n\r\nconst clickContact = ()=>{\r\n\tuni.makePhoneCall({\r\n\t\tphoneNumber:\"114\"\r\n\t})\r\n}\r\n\r\nconst getUserInfo = ()=>{\r\n\tapiUserInfo().then(res=>{\r\n\t\tconsole.log(res);\r\n\t\tuserinfo.value = res.data\r\n\t})\r\n}\r\n\r\nconst wxLogin = () => {\r\n\r\n\tconsole.log('微信登录');\r\n    // 获取code\r\n    wx.login({\r\n        success: (loginRes) => {\r\n\t\t\tconsole.log('登录成功', loginRes);\r\n            if (loginRes.code) {\r\n                // 获取用户信息\r\n                uni.showModal({\r\n                    title: '温馨提示',\r\n                    content: '请先登录',\r\n                    success: function (res) {\r\n                        if (res.confirm) {\r\n                            wx.getUserProfile({\r\n                                desc: '用于完善用户资料',\r\n                                success: (profileRes) => {\r\n                                    const userInfo = profileRes.userInfo;\r\n                                    console.log('登录成功', {\r\n                                        code: loginRes.code,\r\n                                        userInfo: userInfo\r\n                                    });\r\n                                    \r\n                                    // TODO: 调用后端接口，发送code和用户信息\r\n                                    // 示例：\r\n                                    /*\r\n                                    uni.request({\r\n                                        url: '你的接口地址',\r\n                                        method: 'POST',\r\n                                        data: {\r\n                                            code: loginRes.code,\r\n                                            userInfo: userInfo\r\n                                        },\r\n                                        success: (res) => {\r\n                                            // 保存后端返回的token等信息\r\n                                            uni.setStorageSync('token', res.data.token);\r\n                                            getUserInfo(); // 获取用户信息\r\n                                        },\r\n                                        fail: (err) => {\r\n                                            uni.showToast({\r\n                                                title: '登录失败',\r\n                                                icon: 'none'\r\n                                            });\r\n                                        }\r\n                                    });\r\n                                    */\r\n                                    \r\n                                    // 临时：直接获取用户信息\r\n                                    getUserInfo();\r\n                                },\r\n                                fail: (err) => {\r\n                                    console.log('获取用户信息失败', err);\r\n                                    uni.showToast({\r\n                                        title: '获取用户信息失败',\r\n                                        icon: 'none'\r\n                                    });\r\n                                }\r\n                            });\r\n                        }\r\n                    }\r\n                });\r\n            } else {\r\n                uni.showToast({\r\n                    title: '登录失败',\r\n                    icon: 'none'\r\n                });\r\n            }\r\n        },\r\n        fail: (err) => {\r\n            console.log('登录失败', err);\r\n            uni.showToast({\r\n                title: '登录失败',\r\n                icon: 'none'\r\n            });\r\n        },\r\n\t\t\r\n\t\t// wxda74230cc6e6cade\r\n    });\r\n}\r\n\r\n\r\n\r\n// getUserInfo();\r\n\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.userLayout{\r\n\t.userInfo{\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\tflex-direction: column;\t\t\r\n\t\tpadding:50rpx 0;\r\n\t\t.avatar{\r\n\t\t\twidth: 160rpx;\r\n\t\t\theight: 160rpx;\r\n\t\t\tborder-radius: 50%;\r\n\t\t\toverflow: hidden;\r\n\t\t\timage{\r\n\t\t\t\twidth: 100%;\r\n\t\t\t\theight: 100%;\r\n\t\t\t}\r\n\t\t}\r\n\t\t.ip{\r\n\t\t\tfont-size: 44rpx;\r\n\t\t\tcolor:#333;\r\n\t\t\tpadding:20rpx 0 5rpx;\r\n\t\t}\r\n\t\t.address{\r\n\t\t\tfont-size: 28rpx;\r\n\t\t\tcolor:#aaa;\r\n\t\t}\r\n\t\r\n\t}\r\n\t\r\n\t.loginBtn{\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor:#fff;\r\n\t\tbackground: #07c160;\r\n\t\tborder-radius: 30rpx;\r\n\t\tpadding: 20rpx 40rpx;\r\n\t\tmargin-top: 100rpx;\r\n\t\twidth: 690rpx;\r\n\t\tmargin: 0 auto;\r\n\t}\r\n\r\n\r\n\t.section{\r\n\t\twidth: 690rpx;\r\n\t\tmargin:50rpx auto;\r\n\t\tborder:1px solid #eee;\r\n\t\tborder-radius: 10rpx;\r\n\t\tbox-shadow: 0 0 30rpx rgba(0,0,0,0.05);\r\n\t\t.list{\r\n\t\t\t.row{\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tjustify-content: space-between;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tpadding:0 30rpx;\r\n\t\t\t\theight: 100rpx;\r\n\t\t\t\tborder-bottom: 1px solid #eee;\r\n\t\t\t\tposition: relative;\r\n\t\t\t\tbackground: #fff;\r\n\t\t\t\t&:last-child{border-bottom:0}\r\n\t\t\t\t.left{\r\n\t\t\t\t\tdisplay: flex;\r\n\t\t\t\t\talign-items: center;\r\n\t\t\t\t\t:deep(){\r\n\t\t\t\t\t\t.uni-icons{\r\n\t\t\t\t\t\t\tcolor:$brand-theme-color !important;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t.text{\r\n\t\t\t\t\t\tpadding-left: 20rpx;\r\n\t\t\t\t\t\tcolor:#666\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t.right{\r\n\t\t\t\t\tdisplay: flex;\r\n\t\t\t\t\talign-items: center;\r\n\t\t\t\t\t.text{\r\n\t\t\t\t\t\tfont-size: 28rpx;\r\n\t\t\t\t\t\tcolor:#aaa;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tbutton{\r\n\t\t\t\t\tposition: absolute;\r\n\t\t\t\t\ttop:0;\r\n\t\t\t\t\tleft:0;\r\n\t\t\t\t\theight: 100rpx;\r\n\t\t\t\t\twidth:100%;\r\n\t\t\t\t\topacity: 0;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n</style>\r\n","import MiniProgramPage from 'E:/workspace/univue3/wallpaper-kt/pages/user/user.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","apiUserInfo","uni","wx"],"mappings":";;;;;;;;;;;;;;;;AAkHA,UAAM,WAAWA,cAAG,IAAC,IAAI;AAQzB,UAAM,cAAc,MAAI;AACvBC,2BAAa,EAAC,KAAK,SAAK;AACvBC,sBAAAA,MAAY,MAAA,OAAA,8BAAA,GAAG;AACf,iBAAS,QAAQ,IAAI;AAAA,MACvB,CAAE;AAAA,IACF;AAEA,UAAM,UAAU,MAAM;AAErBA,oBAAAA,MAAA,MAAA,OAAA,8BAAY,MAAM;AAEfC,oBAAAA,KAAG,MAAM;AAAA,QACL,SAAS,CAAC,aAAa;AAC5BD,wBAAY,MAAA,MAAA,OAAA,8BAAA,QAAQ,QAAQ;AACnB,cAAI,SAAS,MAAM;AAEfA,0BAAAA,MAAI,UAAU;AAAA,cACV,OAAO;AAAA,cACP,SAAS;AAAA,cACT,SAAS,SAAU,KAAK;AACpB,oBAAI,IAAI,SAAS;AACbC,gCAAAA,KAAG,eAAe;AAAA,oBACd,MAAM;AAAA,oBACN,SAAS,CAAC,eAAe;AACrB,4BAAM,WAAW,WAAW;AAC5BD,oCAAAA,MAAY,MAAA,OAAA,8BAAA,QAAQ;AAAA,wBAChB,MAAM,SAAS;AAAA,wBACf;AAAA,sBACxC,CAAqC;AA2BD;oBACH;AAAA,oBACD,MAAM,CAAC,QAAQ;AACXA,oCAAA,MAAA,MAAA,OAAA,8BAAY,YAAY,GAAG;AAC3BA,oCAAAA,MAAI,UAAU;AAAA,wBACV,OAAO;AAAA,wBACP,MAAM;AAAA,sBAC9C,CAAqC;AAAA,oBACJ;AAAA,kBACjC,CAA6B;AAAA,gBACJ;AAAA,cACJ;AAAA,YACrB,CAAiB;AAAA,UACjB,OAAmB;AACHA,0BAAAA,MAAI,UAAU;AAAA,cACV,OAAO;AAAA,cACP,MAAM;AAAA,YAC1B,CAAiB;AAAA,UACJ;AAAA,QACJ;AAAA,QACD,MAAM,CAAC,QAAQ;AACXA,wBAAA,MAAA,MAAA,OAAA,8BAAY,QAAQ,GAAG;AACvBA,wBAAAA,MAAI,UAAU;AAAA,YACV,OAAO;AAAA,YACP,MAAM;AAAA,UACtB,CAAa;AAAA,QACJ;AAAA;AAAA,MAGT,CAAK;AAAA,IACL;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC9MA,GAAG,WAAW,eAAe;"}